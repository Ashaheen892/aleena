(()=>{"use strict";function t(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function n(t){var n=function(t,n){if("object"!=i(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var a=o.call(t,n||"default");if("object"!=i(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==i(n)?n:n+""}function o(t,i){for(var o=0;o<i.length;o++){var a=i[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,n(a.key),a)}}function a(t,i,n){return i&&o(t.prototype,i),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function e(t,n){if(n&&("object"==i(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function r(t){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},r(t)}function c(t,i){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},c(t,i)}function s(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(s=function(){return!!t})()}function l(t){var i="function"==typeof Map?new Map:void 0;return l=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(i){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==i){if(i.has(t))return i.get(t);i.set(t,n)}function n(){return function(t,i,n){if(s())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,i);var a=new(t.bind.apply(t,o));return n&&c(a,n.prototype),a}(t,arguments,r(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),c(n,t)},l(t)}var d=function(){return a((function i(){t(this,i)}),[{key:"onReady",value:function(){}},{key:"registerEvents",value:function(){}},{key:"initiate",value:function(t){if(t&&!t.includes(salla.config.get("page.slug")))return app.log("The Class For (".concat(t.join(","),") Skipped."));this.onReady(),this.registerEvents(),app.log("The Class For (".concat((null==t?void 0:t.join(","))||"*",") LoadedðŸŽ‰"))}}])}();d.initiateWhenReady=function(){var t,i=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;"ready"===(null===(t=window.app)||void 0===t?void 0:t.status)?(new this).initiate(n):document.addEventListener("theme::ready",(function(){return(new i).initiate(n)}))};function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(u=function(){return!!t})()}var p=function(i){function n(){return t(this,n),i=this,o=r(o=n),e(i,u()?Reflect.construct(o,a||[],r(i).constructor):o.apply(i,a));var i,o,a}return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&c(t,i)}(n,i),a(n,[{key:"connectedCallback",value:function(){var t,i=this;this.product=this.product||JSON.parse(this.getAttribute("product")),"ready"===(null===(t=window.app)||void 0===t?void 0:t.status)?this.onReady():document.addEventListener("theme::ready",(function(){return i.onReady()}))}},{key:"onReady",value:function(){var t=this;this.fitImageHeight=salla.config.get("store.settings.product.fit_type"),this.placeholder=salla.url.asset(salla.config.get("theme.settings.placeholder")),this.getProps(),this.source=salla.config.get("page.slug"),"landing-page"==this.source&&(this.hideAddBtn=!0,this.showQuantity=window.showQuantity),salla.lang.onLoaded((function(){t.remained=salla.lang.get("pages.products.remained"),t.donationAmount=salla.lang.get("pages.products.donation_amount"),t.startingPrice=salla.lang.get("pages.products.starting_price"),t.addToCart=salla.lang.get("pages.cart.add_to_cart"),t.outOfStock=salla.lang.get("pages.products.out_of_stock"),t.render()})),this.render()}},{key:"has3dImage",value:function(){var t;return!(null===(t=this.product.images)||void 0===t||!t.filter((function(t){return t.three_d_image_url})).length)}},{key:"renderImages",value:function(t){var i,n,o,a,e,r=this,c=productcard_images_limit||t.length,s=JSON.stringify({effect:"fade",speed:500});this.querySelector(".product-slider").innerHTML='<salla-slider id="product-slider-'.concat(this.product.id,"-").concat(this.getRandomInt(1,1e4),'" show-controls="true" auto-play=').concat(productcard_autoplay?"true":"false",' class="h-full [&_.swiper]:h-full [&_.swiper]:!m-0 [&_.swiper]:!p-0 [&_.swiper-wrapper]:!p-0 product-slider-fade" slider-config=\'').concat(s,'\'>\n          <div slot="items">\n            <img class="s-product-card-image-').concat(salla.url.is_placeholder(null===(i=this.product)||void 0===i||null===(i=i.image)||void 0===i?void 0:i.url)?"contain":this.fitImageHeight?this.fitImageHeight:"cover",' lazy" src="" alt=').concat(null===(n=this.product)||void 0===n||null===(n=n.image)||void 0===n?void 0:n.alt," data-src=").concat((null===(o=this.product)||void 0===o||null===(o=o.image)||void 0===o?void 0:o.url)||(null===(a=this.product)||void 0===a?void 0:a.thumbnail),' loading="lazy" width="500" height="500"/>\n            ').concat(null===(e=t.slice(1,c))||void 0===e?void 0:e.map((function(t){var i;return"<img data-src=".concat(t.url,' src="" alt=').concat(null==t?void 0:t.alt,' class="s-product-card-image-').concat(salla.url.is_placeholder(null===(i=r.product)||void 0===i||null===(i=i.image)||void 0===i?void 0:i.url)?"contain":r.fitImageHeight?r.fitImageHeight:"cover",' lazy" loading="lazy" width="500" height="500"/>')})),"\n          </div>\n        </salla-slider>")}},{key:"initCircleBar",value:function(){var t=100-this.product.quantity/(this.product.quantity>100?2*this.product.quantity:100)*100;this.querySelector(".s-product-card-content-pie-svg-bar").style.strokeDashoffset=t}},{key:"formatDate",value:function(t){var i=new Date(t);return"".concat(i.getFullYear(),"-").concat(i.getMonth()+1,"-").concat(i.getDate())}},{key:"getProductBadge",value:function(){var t,i,n;return this.product.promotion_title?'<div class="s-product-card-promotion-title">'.concat(this.product.promotion_title,"</div>"):this.showQuantity&&null!==(t=this.product)&&void 0!==t&&t.quantity?'<div\n        class="s-product-card-quantity">'.concat(this.remained," ").concat(salla.helpers.number(null===(n=this.product)||void 0===n?void 0:n.quantity),"</div>"):this.showQuantity&&null!==(i=this.product)&&void 0!==i&&i.is_out_of_stock?'<div class="s-product-card-out-badge">'.concat(this.outOfStock,"</div>"):""}},{key:"getPriceFormat",value:function(t){return t&&0!=t?salla.money(t):salla.config.get("store.settings.product.show_price_as_dash")?"-":""}},{key:"getProductPrice",value:function(){var t,i="";if(this.product.is_on_sale)i='<div class="s-product-card-sale-price">\n                <h4>'.concat(this.getPriceFormat(this.product.sale_price),"</h4>\n                <span>").concat(this.getPriceFormat(null===(t=this.product)||void 0===t?void 0:t.regular_price),"</span>\n              </div>");else if(this.product.starting_price){var n;i='<div class="s-product-card-starting-price">\n                  <p>'.concat(this.startingPrice,"</p>\n                  <h4> ").concat(this.getPriceFormat(null===(n=this.product)||void 0===n?void 0:n.starting_price)," </h4>\n              </div>")}else{var o;i='<h4 class="s-product-card-price">'.concat(this.getPriceFormat(null===(o=this.product)||void 0===o?void 0:o.price),"</h4>")}return i}},{key:"getAddButtonLabel",value:function(){return"sale"===this.product.status&&"booking"===this.product.type?salla.lang.get("pages.cart.book_now"):"sale"===this.product.status?salla.lang.get("pages.cart.add_to_cart"):"donating"!==this.product.type?salla.lang.get("pages.products.out_of_stock"):salla.lang.get("pages.products.donation_exceed")}},{key:"getProps",value:function(){this.horizontal=this.hasAttribute("horizontal"),this.shadowOnHover=this.hasAttribute("shadowOnHover"),this.hideAddBtn=this.hasAttribute("hideAddBtn"),this.fullImage=this.hasAttribute("fullImage"),this.noImage=this.hasAttribute("noImage"),this.minimal=this.hasAttribute("minimal")||null!==this.closest("[minimal]"),this.isSpecial=this.hasAttribute("isSpecial"),this.showQuantity=this.hasAttribute("showQuantity")}},{key:"getRandomInt",value:function(t,i){return t=Math.ceil(t),i=Math.floor(i),Math.floor(Math.random()*(i-t+1))+t}},{key:"render",value:function(){var t,i,n,o,a,e,r,c,s,l,d,u,p,h,g,v,f,m,y,b,_,w,I,S,k,O,P,A,x,L,H,q=this;this.classList.add("s-product-card-entry","!rounded-none"),this.setAttribute("id",this.product.id),!(this.horizontal||this.fullImage||this.minimal)&&this.classList.add("s-product-card-vertical"),this.horizontal&&!this.fullImage&&!this.minimal&&this.classList.add("s-product-card-horizontal"),this.fitImageHeight&&!this.isSpecial&&!this.fullImage&&!this.minimal&&this.classList.add("s-product-card-fit-height"),this.isSpecial&&this.classList.add("s-product-card-special"),this.fullImage&&this.classList.add("s-product-card-full-image"),this.minimal&&this.classList.add("s-product-card-minimal"),null!==(t=this.product)&&void 0!==t&&t.donation&&this.classList.add("s-product-card-donation"),this.shadowOnHover&&this.classList.add("s-product-card-shadow"),this.isInWishlist=!salla.config.isGuest()&&salla.storage.get("salla::wishlist",[]).includes(this.product.id);var j=productcard_options&&(null===(i=this.product.options)||void 0===i?void 0:i.length),z=(null===(n=this.product.images)||void 0===n?void 0:n.length)>1,B=productcard_metadata&&this.product.metadata;this.innerHTML='\n        <div class="h-full !rounded-none '.concat(this.fullImage?"s-product-card-image-full":"s-product-card-image",'">\n          <a href="').concat(null===(o=this.product)||void 0===o?void 0:o.url,'" class="relative h-full block">\n          ').concat(null!==(a=this.product)&&void 0!==a&&a.is_out_of_stock?'<strong class="productout-stock w-3/4 md:w-1/2 text-center absolute top-1/2 -translate-y-1/2 left-0 right-0 my-0 mx-auto block uppercase text-base font-semibold leading-4 text-red-500 p-1 md:p-3 border border-solid border-red-500 bg-clip-padding -rotate-45 z-10">'.concat(salla.lang.get("pages.products.out_of_stock"),'</strong>\n              <img class="flex s-product-card-image-').concat(salla.url.is_placeholder(null===(e=this.product)||void 0===e||null===(e=e.image)||void 0===e?void 0:e.url)?"contain":this.fitImageHeight?this.fitImageHeight:"cover",' lazy"\n                src=""\n                alt=').concat(null===(r=this.product)||void 0===r||null===(r=r.image)||void 0===r?void 0:r.alt,"\n                data-src=").concat((null===(c=this.product)||void 0===c||null===(c=c.image)||void 0===c?void 0:c.url)||(null===(s=this.product)||void 0===s?void 0:s.thumbnail),'\n                width="500" height="500"\n              />\n              '):"\n        ".concat(z?'<div class="product-slider h-full hidden md:flex"></div>\n              <img class="flex md:hidden s-product-card-image-'.concat(salla.url.is_placeholder(null===(l=this.product)||void 0===l||null===(l=l.image)||void 0===l?void 0:l.url)?"contain":this.fitImageHeight?this.fitImageHeight:"cover",' lazy"\n                src=""\n                alt=').concat(null===(d=this.product)||void 0===d||null===(d=d.image)||void 0===d?void 0:d.alt,"\n                data-src=").concat((null===(u=this.product)||void 0===u||null===(u=u.image)||void 0===u?void 0:u.url)||(null===(p=this.product)||void 0===p?void 0:p.thumbnail),'\n                width="500" height="500"\n              />\n            '):'<img class="test s-product-card-image-'.concat(salla.url.is_placeholder(null===(h=this.product)||void 0===h||null===(h=h.image)||void 0===h?void 0:h.url)?"contain":this.fitImageHeight?this.fitImageHeight:"cover",' lazy"\n                src=""\n                alt=').concat(null===(g=this.product)||void 0===g||null===(g=g.image)||void 0===g?void 0:g.alt,"\n                data-src=").concat((null===(v=this.product)||void 0===v||null===(v=v.image)||void 0===v?void 0:v.url)||(null===(f=this.product)||void 0===f?void 0:f.thumbnail),'\n                width="500" height="500"\n              />'),"\n"),"\n            ").concat(this.fullImage||this.minimal?"":this.getProductBadge(),"\n\n            ").concat(this.has3dImage()&&productcard_show_3d_icon?'<span class="sicon-d-rotate s-product-card-3d-icon"></span>':"","\n          </a>\n          ").concat(this.fullImage?'<a href="'.concat(null===(m=this.product)||void 0===m?void 0:m.url,'" aria-label=').concat(this.product.name,' class="s-product-card-overlay"></a>'):"",'\n        </div>\n        <div class="s-product-card-content">\n          ').concat(this.isSpecial&&null!==(y=this.product)&&void 0!==y&&y.quantity?'<div class="s-product-card-content-pie">\n              <span>\n                <b>'.concat(salla.helpers.number(null===(b=this.product)||void 0===b?void 0:b.quantity),"</b>\n                ").concat(this.remained,'\n              </span>\n              <svg xmlns="http://www.w3.org/2000/svg" viewBox="-2 -1 36 34" class="s-product-card-content-pie-svg">\n                <circle cx="16" cy="16" r="15.9155" class="s-product-card-content-pie-svg-base" />\n                <circle cx="16" cy="16" r="15.9155" class="s-product-card-content-pie-svg-bar" />\n              </svg>\n            </div>'):"",'\n\n          <div class="s-product-card-content-main ').concat(this.isSpecial?"s-product-card-content-extra-padding":"",'">\n            <h3 class="s-product-card-content-title line-clamp-1 md:line-clamp-2">\n              <a href="').concat(null===(_=this.product)||void 0===_?void 0:_.url,'">').concat(null===(w=this.product)||void 0===w?void 0:w.name,"</a>\n            </h3>\n\n            ").concat(null!==(I=this.product)&&void 0!==I&&I.subtitle&&!this.minimal?'<p class="s-product-card-content-subtitle opacity-80">'.concat(null===(S=this.product)||void 0===S?void 0:S.subtitle,"</p>"):"","\n          </div>\n          ").concat(null===(k=this.product)||void 0===k||!k.donation||this.minimal||this.fullImage?"":"<salla-progress-bar donation=".concat(JSON.stringify(null===(O=this.product)||void 0===O?void 0:O.donation),'></salla-progress-bar>\n          <div class="s-product-card-donation-input">\n            ').concat(null!==(P=this.product)&&void 0!==P&&null!==(P=P.donation)&&void 0!==P&&P.can_donate?'<label for="donation-amount-'.concat(this.product.id,'">').concat(this.donationAmount,' <span>*</span></label>\n              <input\n                type="text"\n                onInput="').concat((function(t){salla.helpers.inputDigitsOnly(t.target),q.addBtn.donatingAmount=t.target.value}),'"\n                id="donation-amount-').concat(this.product.id,'"\n                name="donating_amount"\n                class="s-form-control"\n                placeholder="').concat(this.donationAmount,'" />'):"","\n          </div>"),'\n          <div class="s-product-card-content-sub ').concat(this.isSpecial?"s-product-card-content-extra-padding":"",'">\n            ').concat(null!==(A=this.product)&&void 0!==A&&null!==(A=A.donation)&&void 0!==A&&A.can_donate?"":this.getProductPrice(),"\n            ").concat(null!==(x=this.product)&&void 0!==x&&null!==(x=x.rating)&&void 0!==x&&x.stars?'<div class="s-product-card-rating">\n                <i class="sicon-star2 before:text-orange-300"></i>\n                <span>'.concat(this.product.rating.stars,"</span>\n              </div>"):"","\n          </div>\n\n          ").concat(this.isSpecial&&this.product.discount_ends?'<salla-count-down date="'.concat(this.formatDate(this.product.discount_ends),'" end-of-day=',!0," boxed=",!0,"\n              labeled=",!0," />"):"","\n        </div>\n      "),this.querySelectorAll('[name="donating_amount"]').forEach((function(t){t.addEventListener("input",(function(t){t.target.closest(".s-product-card-content").querySelector("salla-add-product-button").setAttribute("donating-amount",t.target.value)}))})),null===(L=document.lazyLoadInstance)||void 0===L||L.update(this.querySelectorAll(".lazy")),this.querySelector(".product-slider")&&this.renderImages(this.product.images),j&&this.querySelector(".product-options")&&this.renderOptions(this.product.options),B&&this.querySelector(".product-metadata")&&this.renderMetadata(this.product.metadata),null!==(H=this.product)&&void 0!==H&&H.quantity&&this.isSpecial&&this.initCircleBar()}}])}(l(HTMLElement));customElements.define("custom-salla-product-card",p)})();